// js/main.js

document.addEventListener("DOMContentLoaded", () => {
  const elements = {
    menu: document.getElementById("menu"), 
    menuBackground: document.getElementById('menu-background'),
    initialStartBtn: document.getElementById('initial-start-btn'),
    gameUI: document.getElementById("game"), 
    startBtn: document.getElementById("start-btn"),
    seedInput: document.getElementById("seed"),
    trackWrapper: document.getElementById("track-wrapper"), 
    trackContainer: document.getElementById("track-container"),
    trackImage: document.getElementById("track-image"), 
    trackCredit: document.getElementById("track-credit"),
    trackNameDisplay: document.getElementById("track-name-display"),
    confirmBtn: document.getElementById("confirm-btn"), 
    nextBtn: document.getElementById("next-btn"),
    roundDisplay: document.getElementById("round-display"), 
    scoreDisplay: document.getElementById("score-display"),
    resultText: document.getElementById("result"), 
    mapWrapper: document.getElementById("map-wrapper"), 
    mapContainer: document.getElementById("map-container"),
    mapImage: document.getElementById("track-map"),
    markerGuess: document.getElementById("marker-guess"), 
    markerPlayer: document.getElementById("marker-player"), 
    markerAnswer: document.getElementById("marker-answer"),
    guessLine: document.getElementById("guess-line"), 
    statusText: document.getElementById("used-images-status"), 
    leaderboardList: document.getElementById("leaderboard-list"), 
    backToMenuBtn: document.getElementById("back-to-menu-btn"),
    endGameModal: document.getElementById("end-game-modal"), 
    modalFinalScore: document.getElementById("modal-final-score"),
    saveScoreForm: document.getElementById("save-score-form"), 
    playerNameInput: document.getElementById("player-name-input"),
    saveScoreBtn: document.getElementById("save-score-btn"), 
    modalPlayAgainBtn: document.getElementById("modal-play-again-btn"),
    modalBackToMenuBtn: document.getElementById("modal-back-to-menu-btn"),
    modalSeedContainer: document.getElementById("modal-seed-container"),
    themeSelector: document.getElementById('theme-selector'),
    customBgColorInput: document.getElementById('custom-bg-color'),
    roundTimerInput: document.getElementById('round-timer-input'),
    unlimitedTimeCheckbox: document.getElementById('unlimited-time-checkbox'),
    timerDisplay: document.getElementById('timer-display'),
    fadeTimerInput: document.getElementById('fade-timer-input'),
    fadeTimerCheckbox: document.getElementById('fade-timer-checkbox'),
    endGameBtn: document.getElementById('end-game-btn'),
    magnifier: document.getElementById('magnifier'),
    modeSelector: document.getElementById('mode-selector'),
    modeOptionsContainer: document.getElementById('mode-options-container'),
    modeOptionTrack: document.getElementById('mode-option-track'),
    modeOptionMap: document.getElementById('mode-option-map'),
    modeOptionSite: document.getElementById('mode-option-site'),
    siteOptionWrapper: document.getElementById('site-option-wrapper'),
    resetModeBtn: document.getElementById('reset-mode-btn'),
    randomizerBtn: document.getElementById('randomizer-btn'),
    randomizerModal: document.getElementById('randomizer-modal'),
    startRandomBtn: document.getElementById('start-random-btn'),
    cancelRandomBtn: document.getElementById('cancel-random-btn'),
    resetRandomBtn: document.getElementById('reset-random-btn'),
    randModeMirror: document.getElementById('rand-mode-mirror'),
    randModeInverted: document.getElementById('rand-mode-inverted'),
    randMirrorOptions: document.getElementById('rand-mirror-options'),
    randMirrorTrack: document.getElementById('rand-mirror-track'),
    randMirrorMap: document.getElementById('rand-mirror-map'),
    randMirrorSite: document.getElementById('rand-mirror-site'),
    randInvertedOptions: document.getElementById('rand-inverted-options'),
    randInvertedTrack: document.getElementById('rand-inverted-track'),
    randInvertedMap: document.getElementById('rand-inverted-map'),
    randInvertedSite: document.getElementById('rand-inverted-site'),
    randTimerEnable: document.getElementById('rand-timer-enable'),
    randTimerMin: document.getElementById('rand-timer-min'),
    randTimerMax: document.getElementById('rand-timer-max'),
    randFadeEnable: document.getElementById('rand-fade-enable'),
    randFadeMin: document.getElementById('rand-fade-min'),
    randFadeMax: document.getElementById('rand-fade-max'),
    showFadeTimerCheckbox: document.getElementById('show-fade-timer-checkbox'),
    fadeTimerDisplay: document.getElementById('fade-timer-display'),
    activeSettingsDisplay: document.getElementById('active-settings-display'),
    randPerGame: document.getElementById('rand-per-game'),
    randPerRound: document.getElementById('rand-per-round'),
    fragmentOverlay: document.getElementById('fragment-overlay'),
    revealFragmentBtn: document.getElementById('reveal-fragment-btn'),
    fragmentedOptionsContainer: document.getElementById('fragmented-options-container'),
    fragmentCost: document.getElementById('fragment-cost'),
    fragmentGridSize: document.getElementById('fragment-grid-size'),
    fragmentInitialReveals: document.getElementById('fragment-initial-reveals'),
    randModeFragmented: document.getElementById('rand-mode-fragmented'),
    randFragmentedOptions: document.getElementById('rand-fragmented-options'),
    randFragCostEnable: document.getElementById('rand-frag-cost-enable'),
    randFragCostMin: document.getElementById('rand-frag-cost-min'),
    randFragCostMax: document.getElementById('rand-frag-cost-max'),
    randFragInitialEnable: document.getElementById('rand-frag-initial-enable'),
    randFragInitialMin: document.getElementById('rand-frag-initial-min'),
    randFragInitialMax: document.getElementById('rand-frag-initial-max'),
    randFragGridRandom: document.getElementById('rand-frag-grid-random'),
    randFragGrid2x2: document.getElementById('rand-frag-grid-2x2'),
    randFragGrid2x3: document.getElementById('rand-frag-grid-2x3'),
    randFragGrid3x3: document.getElementById('rand-frag-grid-3x3'),
    customImageGrid: document.getElementById('custom-image-grid'),
    selectAllBtn: document.getElementById('select-all-btn'),
    deselectAllBtn: document.getElementById('deselect-all-btn'),
    startCustomGameBtn: document.getElementById('start-custom-game-btn'),
    // Challenge UI Elements
    createChallengeBtn: document.getElementById('create-challenge-btn'),
    playChallengeBtn: document.getElementById('play-challenge-btn'),
    createChallengeModal: document.getElementById('create-challenge-modal'),
    playChallengeModal: document.getElementById('play-challenge-modal'),
    challengeImageGrid: document.getElementById('challenge-image-grid'),
    challengeSelectedRounds: document.getElementById('challenge-selected-rounds'),
    challengeRandomizeImagesBtn: document.getElementById('challenge-randomize-images-btn'),
    challengeGenerateBtn: document.getElementById('challenge-generate-btn'),
    challengeResultContainer: document.getElementById('challenge-result-container'),
    challengeCodeOutput: document.getElementById('challenge-code-output'),
    challengeLinkOutput: document.getElementById('challenge-link-output'),
    challengeCodeInput: document.getElementById('challenge-code-input'),
    startChallengeBtn: document.getElementById('start-challenge-btn'),
  };
  
  initializeUI(elements);
  const game = new Game(elements);
  initializeCustomGameUI(elements, game);
  initializeChallengeUI(elements, game);
});